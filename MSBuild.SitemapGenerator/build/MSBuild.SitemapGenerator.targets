<Project>
  <UsingTask TaskName="MSBuild.SitemapGenerator.GenerateSitemap" AssemblyFile="$(MSBuildThisFileDirectory)../lib/netstandard2.0/MSBuild.SitemapGenerator.dll" />

  <Target Name="GenerateSitemapAfterPublish" AfterTargets="Publish">
    <ItemGroup>
      <_SitemapRules Include="@(SitemapRule)" />
    </ItemGroup>

    <Error Condition="'$(SitemapBaseUrl)' == ''" Text="SitemapBaseUrl must be specified in the project file." />

    <Message Importance="High" Text="Running GenerateSitemap task... PublishDir: '$(PublishDir)wwwroot/', BaseUrl: '$(SitemapBaseUrl)'" />
    <GenerateSitemap PublishDir="$(PublishDir)wwwroot/" BaseUrl="$(SitemapBaseUrl)" Rules="@(_SitemapRules)" />
  </Target>
</Project>
